<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ event.title }} ìƒì„¸/ìˆ˜ì • | ê¸°ê°„ í•œì • ì•Œë¦¼</title>
    <style>
        body { font-family: sans-serif; margin: 40px; background-color: #f4f4f9; }
        .container { max-width: 800px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        h1 { color: #333; border-bottom: 2px solid #ddd; padding-bottom: 10px; margin-bottom: 30px;}
        .detail-group { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px dashed #eee; }
        .detail-group label { font-weight: bold; color: #555; display: block; margin-bottom: 5px; }
        .detail-group p { margin: 0; padding-left: 10px; font-size: 1.1em; color: #333; }
        
        /* ìˆ˜ì • í¼ ìŠ¤íƒ€ì¼ */
        form { margin-top: 30px; padding-top: 20px; border-top: 2px solid #ddd; }
        label { display: block; margin-top: 15px; font-weight: bold; color: #555; }
        input[type="text"], input[type="date"], textarea, select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        textarea { resize: vertical; height: 100px; }
        .form-group { margin-bottom: 20px; }

        /* ë²„íŠ¼ ê·¸ë£¹ ë° ìƒ‰ìƒ */
        .button-group { 
            margin-top: 30px; 
            display: flex; 
            gap: 10px; 
            align-items: center; /* ë²„íŠ¼ì„ ì„¸ë¡œë¡œ ì •ë ¬ */
        }
        .btn { 
            padding: 10px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 16px; 
            text-decoration: none; 
            text-align: center;
            height: 40px; 
            line-height: 20px;
            box-sizing: border-box;
            white-space: nowrap; /* ë²„íŠ¼ ë‚´ìš©ì´ ì¤„ë°”ê¿ˆë˜ì§€ ì•Šë„ë¡ */
        }
        .btn-toggle { background-color: #ffc107; color: #333; }
        .btn-delete { background-color: #dc3545; color: white; }
        .btn-save { background-color: #007bff; color: white; }
        .btn-cancel { background-color: #6c757d; color: white; }

        /* ì‚­ì œ í¼ì„ ì¸ë¼ì¸ ë¸”ë¡ìœ¼ë¡œ ë§Œë“¤ì–´ ìˆ˜ì • ë²„íŠ¼ ì˜†ì— ë°°ì¹˜ */
        #delete-form {
            display: inline-block;
            margin: 0; /* formì˜ ê¸°ë³¸ ë§ˆì§„ ì œê±° */
            padding: 0; /* formì˜ ê¸°ë³¸ íŒ¨ë”© ì œê±° */
        }
    </style>
    <script>
        // JavaScriptë¥¼ ê°„ì†Œí™”í•˜ì—¬ ë‘ ì˜ì—­ì˜ í‘œì‹œë¥¼ í† ê¸€
        function toggleEditMode() {
            const displayContent = document.getElementById('display-content');
            const editForm = document.getElementById('edit-form');
            const toggleButton = document.getElementById('toggle-button');
            
            // í˜„ì¬ ìˆ˜ì • í¼ì´ ìˆ¨ê²¨ì ¸ ìˆë‹¤ë©´ (ìˆ˜ì • ëª¨ë“œ ì§„ì…)
            if (editForm.style.display === 'none' || editForm.style.display === '') {
                displayContent.style.display = 'none';
                editForm.style.display = 'block';
                toggleButton.textContent = 'ìˆ˜ì • ì·¨ì†Œ';
            } else { // ìˆ˜ì • í¼ì´ í‘œì‹œë˜ì–´ ìˆë‹¤ë©´ (ìˆ˜ì • ëª¨ë“œ ì·¨ì†Œ)
                editForm.style.display = 'none';
                displayContent.style.display = 'block';
                toggleButton.textContent = 'ì´ë²¤íŠ¸ ìˆ˜ì •';
            }
        }

        // ì‚­ì œ í™•ì¸ í¼ ì œì¶œ í•¨ìˆ˜ (ê²½ê³  ë©”ì‹œì§€ ëŒ€ì²´)
        function confirmDelete() {
            // ì‚¬ìš©ìì—ê²Œ ê²½ê³  ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ëŒ€ì‹ , í¼ì„ ë°”ë¡œ ì œì¶œí•˜ì—¬ ì‚­ì œ
            document.getElementById('delete-form').submit();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìˆ˜ì • í¼ì„ ìˆ¨ê¹€
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('edit-form').style.display = 'none';
        });

    </script>
</head>
<body>
    <div class="container">
        <h1>{{ event.title }}</h1>
        <p><a href="{{ url_for('event_list') }}">â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a></p>

        <!-- Display Mode (ìƒì„¸ ì •ë³´) -->
        <div class="display-mode" id="display-content">
            <div class="detail-group">
                <label>ì¹´í…Œê³ ë¦¬</label>
                <p>{{ event.category.category_name }}</p>
            </div>
            <div class="detail-group">
                <label>ì¥ì†Œ/ìœ„ì¹˜</label>
                <p>{{ event.location }}</p>
            </div>
            <div class="detail-group">
                <label>ê¸°ê°„</label>
                <p>{{ event.start_date.strftime('%Y.%m.%d') }} ~ {{ event.end_date.strftime('%Y.%m.%d') }}</p>
            </div>
            <div class="detail-group">
                <label>ìƒì„¸ ë‚´ìš©</label>
                <p>{{ event.description or 'ìƒì„¸ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.' }}</p>
            </div>
        </div>
        
        <!-- Buttons Group -->
        <div class="button-group">
            <!-- ìˆ˜ì • ë²„íŠ¼ (í† ê¸€ ê¸°ëŠ¥) -->
            <button class="btn btn-toggle" id="toggle-button" onclick="toggleEditMode()">ì´ë²¤íŠ¸ ìˆ˜ì •</button>

            <!-- ì‚­ì œ ë²„íŠ¼ (Delete Form) -->
            <!-- ì‚­ì œ ë²„íŠ¼ë„ .btn ìŠ¤íƒ€ì¼ì„ ì ìš©ë°›ë„ë¡ <button> íƒœê·¸ì— ì§ì ‘ classë¥¼ ì¶”ê°€ -->
            <form id="delete-form" method="POST" action="{{ url_for('event_delete', event_id=event.event_id) }}">
                <button type="button" onclick="confirmDelete()" class="btn btn-delete">ğŸ—‘ï¸ ì´ë²¤íŠ¸ ì‚­ì œ</button>
            </form>
        </div>

        <!-- Edit Mode (ìˆ˜ì • í¼) -->
        <!-- POST ë©”ì„œë“œë¡œ í˜„ì¬ í˜ì´ì§€(/<event_id>)ì— ë°ì´í„°ë¥¼ ì „ì†¡í•˜ì—¬ ìˆ˜ì • ë¡œì§ ì‹¤í–‰ -->
        <form method="POST" action="{{ url_for('event_detail', event_id=event.event_id) }}" class="edit-mode" id="edit-form">
            <h2>ì´ë²¤íŠ¸ ì •ë³´ ìˆ˜ì • (CRUD: Update)</h2>
            
            <div class="form-group">
                <label for="title">ì œëª©</label>
                <!-- valueì— í˜„ì¬ ì´ë²¤íŠ¸ ì œëª©ì„ ë¯¸ë¦¬ ì±„ì›Œ ë„£ìŒ -->
                <input type="text" id="title" name="title" value="{{ event.title }}" required>
            </div>

            <div class="form-group">
                <label for="category_id">ì¹´í…Œê³ ë¦¬</label>
                <select id="category_id" name="category_id" required>
                    {% for cat in categories %}
                    <!-- í˜„ì¬ ì¹´í…Œê³ ë¦¬ê°€ ì„ íƒë˜ë„ë¡ 'selected' ì²˜ë¦¬ -->
                    <option value="{{ cat.category_id }}" {% if cat.category_id == event.category_id %}selected{% endif %}>
                        {{ cat.category_name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group">
                <label for="location">ì¥ì†Œ/ìœ„ì¹˜</label>
                <input type="text" id="location" name="location" value="{{ event.location }}" required>
            </div>

            <div style="display: flex; gap: 20px;">
                <div class="form-group" style="flex: 1;">
                    <label for="start_date">ì‹œì‘ì¼</label>
                    <!-- valueëŠ” 'YYYY-MM-DD' ë¬¸ìì—´ì´ì–´ì•¼ í•˜ë¯€ë¡œ strftime ì‚¬ìš© -->
                    <input type="date" id="start_date" name="start_date" value="{{ event.start_date.strftime('%Y-%m-%d') }}" required>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="end_date">ì¢…ë£Œì¼</label>
                    <input type="date" id="end_date" name="end_date" value="{{ event.end_date.strftime('%Y-%m-%d') }}" required>
                </div>
            </div>
            
            <div class="form-group">
                <label for="description">ìƒì„¸ ë‚´ìš©</label>
                <textarea id="description" name="description">{{ event.description or '' }}</textarea>
            </div>
            
            <div class="button-group">
                <button type="submit" class="btn btn-save">ğŸ’¾ ìˆ˜ì • ì‚¬í•­ ì €ì¥</button>
                <button type="button" class="btn btn-cancel" onclick="toggleEditMode()">ì·¨ì†Œ</button>
            </div>
        </form>

    </div>
</body>
</html>